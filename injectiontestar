-- ✅ Script completo: ESP + Speed + Jump + Salvar/Voltar posição
-- ✅ Speed sem puxar para trás
-- ✅ Voltar posição rápido e girando
-- ✅ Funciona mesmo após morrer

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

-- Estado
local ESPAtivo, SpeedAtivo, JumpAtivo = false, false, false
local VelocidadeDesejada = 100
local JumpPowerDesejado = 100
local posicaoSalva = nil
local speedConn, diedConn

-- Função para ESP simples (exemplo placeholder)
local function ToggleESP(state)
    ESPAtivo = state
    print("ESP:", state and "ON" or "OFF")
end

-- Função Speed sem puxar para trás
local function StartEnforceSpeed(humanoid)
    StopEnforceSpeed()
    local char = LocalPlayer.Character
    local hrp = char and char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    speedConn = RunService.Heartbeat:Connect(function()
        if SpeedAtivo and humanoid and humanoid.Parent and hrp and hrp.Parent then
            local moveDir = humanoid.MoveDirection
            if moveDir.Magnitude > 0.01 then
                hrp.AssemblyLinearVelocity = Vector3.new(
                    moveDir.X * VelocidadeDesejada,
                    hrp.AssemblyLinearVelocity.Y,
                    moveDir.Z * VelocidadeDesejada
                )
            end
        end
    end)

    diedConn = humanoid.Died:Connect(function()
        StopEnforceSpeed()
    end)
end

function StopEnforceSpeed()
    if speedConn then speedConn:Disconnect() end
    if diedConn then diedConn:Disconnect() end
end

-- Função Jump
local function SetJump(state, humanoid)
    JumpAtivo = state
    humanoid.UseJumpPower = true
    humanoid.JumpPower = state and JumpPowerDesejado or 50
end

-- Salvar posição
local function SalvarPosicao()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        posicaoSalva = char.HumanoidRootPart.Position
        print("Posição salva:", posicaoSalva)
    end
end

-- Voltar posição rápido com giro
local function VoltarPosicao()
    if not posicaoSalva then return end
    local char = LocalPlayer.Character
    local hrp = char and char:FindFirstChild("HumanoidRootPart")
    local humanoid = char and char:FindFirstChildOfClass("Humanoid")
    if not hrp or not humanoid then return end

    local conn
    conn = RunService.Heartbeat:Connect(function()
        if not hrp.Parent then conn:Disconnect() return end
        local diff = posicaoSalva - hrp.Position
        local dist = diff.Magnitude
        if dist < 1 then
            conn:Disconnect()
        else
            local dir = diff.Unit
            hrp.CFrame = CFrame.lookAt(hrp.Position, posicaoSalva)
            humanoid:MoveTo(hrp.Position + dir * 15) -- passos de 15 studs
        end
    end)
end

-- Reconectar eventos ao respawn
local function Setup()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoid = char:WaitForChild("Humanoid")

    if SpeedAtivo then StartEnforceSpeed(humanoid) end
    if JumpAtivo then SetJump(true, humanoid) end

    humanoid.Died:Connect(function()
        StopEnforceSpeed()
    end)
end

LocalPlayer.CharacterAdded:Connect(Setup)
if LocalPlayer.Character then Setup() end

-- Interface Azul Injection - Roblox
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.ResetOnSpawn = false

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 200, 0, 250)
Frame.Position = UDim2.new(0, 20, 0, 20)
Frame.BackgroundColor3 = Color3.fromRGB(0, 30, 60)
Frame.Visible = true

local UICorner = Instance.new("UICorner", Frame)
UICorner.CornerRadius = UDim.new(0, 8)

local function AddButton(text, order, callback)
    local btn = Instance.new("TextButton", Frame)
    btn.Size = UDim2.new(1, -20, 0, 30)
    btn.Position = UDim2.new(0, 10, 0, 40 + (order - 1) * 35)
    btn.BackgroundColor3 = Color3.fromRGB(0, 60, 120)
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Text = text
    btn.MouseButton1Click:Connect(callback)

    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(0, 6)
end

AddButton("ESP", 1, function()
    ESPAtivo = not ESPAtivo
    ToggleESP(ESPAtivo)
end)

AddButton("Speed", 2, function()
    SpeedAtivo = not SpeedAtivo
    if SpeedAtivo then
        StartEnforceSpeed(LocalPlayer.Character:FindFirstChildOfClass("Humanoid"))
    else
        StopEnforceSpeed()
    end
end)

AddButton("Jump", 3, function()
    JumpAtivo = not JumpAtivo
    SetJump(JumpAtivo, LocalPlayer.Character:FindFirstChildOfClass("Humanoid"))
end)

AddButton("Salvar Posição", 4, function()
    SalvarPosicao()
end)

AddButton("Voltar Posição", 5, function()
    VoltarPosicao()
end)

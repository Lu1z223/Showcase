-- ✅ ESP + Speed (suave) + Jump corrigidos para "Roube Um Brainrot"
-- ✅ Interface Azul
-- ✅ Autorizado para testes

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

local ESPAtivo, SpeedAtivo, JumpAtivo = false, false, false
local VelocidadeDesejada = 100
local JumpPowerDesejado = 100
local Drawings = {}

-- 🎨 Cria GUI com cor azul
local function CriarInterface()
    local gui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
    gui.ResetOnSpawn = false
    gui.Name = "PainelHack"

    local frame = Instance.new("Frame", gui)
    frame.Size = UDim2.new(0, 200, 0, 180)
    frame.Position = UDim2.new(0, 10, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(20, 20, 50)
    frame.BorderSizePixel = 0

    local titulo = Instance.new("TextLabel", frame)
    titulo.Size = UDim2.new(1, 0, 0, 30)
    titulo.BackgroundColor3 = Color3.fromRGB(0, 85, 255)
    titulo.Text = "Painel de Hacks"
    titulo.TextColor3 = Color3.fromRGB(255, 255, 255)
    titulo.TextSize = 18
    titulo.Font = Enum.Font.SourceSansBold

    local function CriarBotao(texto, posY, aoClicar)
        local botao = Instance.new("TextButton", frame)
        botao.Size = UDim2.new(1, -20, 0, 30)
        botao.Position = UDim2.new(0, 10, 0, posY)
        botao.BackgroundColor3 = Color3.fromRGB(0, 40, 100)
        botao.TextColor3 = Color3.new(1, 1, 1)
        botao.Font = Enum.Font.SourceSans
        botao.TextSize = 16
        botao.Text = texto
        botao.MouseButton1Click:Connect(function()
            aoClicar(botao)
        end)
    end

    CriarBotao("ESP: OFF", 40, function(btn)
        ESPAtivo = not ESPAtivo
        btn.Text = ESPAtivo and "ESP: ON" or "ESP: OFF"
    end)

    CriarBotao("Speed: OFF", 80, function(btn)
        SpeedAtivo = not SpeedAtivo
        btn.Text = SpeedAtivo and "Speed: ON" or "Speed: OFF"
    end)

    CriarBotao("Jump: OFF", 120, function(btn)
        JumpAtivo = not JumpAtivo
        btn.Text = JumpAtivo and "Jump: ON" or "Jump: OFF"
    end)
end

-- 🔲 Cria caixa 2D para cada jogador
local function CriarCaixa(plr)
    local box = Drawing.new("Square")
    box.Visible = false
    box.Thickness = 2
    box.Color = Color3.fromRGB(0, 255, 255)
    box.Filled = false
    Drawings[plr] = box
end

-- 🧍 Cria ESP para todos os jogadores existentes
for _, p in ipairs(Players:GetPlayers()) do
    if p ~= LocalPlayer then
        CriarCaixa(p)
    end
end

-- 📌 Novo jogador
Players.PlayerAdded:Connect(function(p)
    if p ~= LocalPlayer then
        CriarCaixa(p)
    end
end)

-- 🗑 Remove desenho ao sair
Players.PlayerRemoving:Connect(function(p)
    if Drawings[p] then
        Drawings[p]:Remove()
        Drawings[p] = nil
    end
end)

-- 🔁 Atualiza as caixas no ESP + aplica Speed/Jump suave
RunService.RenderStepped:Connect(function()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            local box = Drawings[plr]
            if not box then
                CriarCaixa(plr)
                box = Drawings[plr]
            end
            local char = plr.Character
            local hrp = char and char:FindFirstChild("HumanoidRootPart")
            local head = char and char:FindFirstChild("Head")

            if ESPAtivo and hrp and head and (not plr.Team or plr.Team ~= LocalPlayer.Team) then
                local top = Camera:WorldToViewportPoint(head.Position + Vector3.new(0, 0.5, 0))
                local bottom = Camera:WorldToViewportPoint(hrp.Position - Vector3.new(0, 2.5, 0))
                if bottom.Z > 0 then
                    local height = math.abs(top.Y - bottom.Y)
                    local width = height / 2
                    box.Size = Vector2.new(width, height)
                    box.Position = Vector2.new(top.X - width / 2, top.Y)
                    box.Visible = true
                else
                    box.Visible = false
                end
            else
                box.Visible = false
            end
        end
    end

    -- 💨 Speed suave
    if SpeedAtivo and LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character.Humanoid.WalkSpeed = VelocidadeDesejada
    elseif LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character.Humanoid.WalkSpeed = 16
    end

    -- 🦘 Jump
    if JumpAtivo and LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character.Humanoid.JumpPower = JumpPowerDesejado
        LocalPlayer.Character.Humanoid.UseJumpPower = true
    elseif LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
        LocalPlayer.Character.Humanoid.JumpPower = 50
        LocalPlayer.Character.Humanoid.UseJumpPower = true
    end
end)

-- 🔄 Reaplica ao renascer
LocalPlayer.CharacterAdded:Connect(function(char)
    char:WaitForChild("Humanoid")
    if SpeedAtivo then
        char.Humanoid.WalkSpeed = VelocidadeDesejada
    end
    if JumpAtivo then
        char.Humanoid.JumpPower = JumpPowerDesejado
        char.Humanoid.UseJumpPower = true
    end
end)

-- 🟦 Inicializa
CriarInterface()

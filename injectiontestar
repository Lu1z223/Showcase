-- Script com ESP + Speed e Interface Melhorada
-- Feito para fins de teste autorizados

-- Configurações iniciais
local ESPAtivo = false
local SpeedAtivo = false
local VelocidadeDesejada = 50
local DesenhosESP = {}
local InterfaceAberta = true

-- Criar Interface Completa
local function CriarInterface()
    local player = game.Players.LocalPlayer
    local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
    gui.Name = "Script_Interface"
    gui.ResetOnSpawn = false

    -- Janela principal
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 200, 0, 150)
    frame.Position = UDim2.new(0, 10, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    frame.BorderSizePixel = 0
    frame.Name = "Painel"
    frame.Parent = gui

    -- Título
    local titulo = Instance.new("TextLabel")
    titulo.Size = UDim2.new(1, 0, 0, 30)
    titulo.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    titulo.Text = "Painel de Hacks"
    titulo.TextColor3 = Color3.fromRGB(255, 255, 255)
    titulo.TextSize = 18
    titulo.Font = Enum.Font.SourceSansBold
    titulo.Parent = frame

    -- Botão ESP
    local botaoESP = Instance.new("TextButton")
    botaoESP.Size = UDim2.new(1, -20, 0, 30)
    botaoESP.Position = UDim2.new(0, 10, 0, 40)
    botaoESP.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    botaoESP.TextColor3 = Color3.fromRGB(255, 255, 255)
    botaoESP.Text = "ESP: OFF"
    botaoESP.Parent = frame

    botaoESP.MouseButton1Click:Connect(function()
        ESPAtivo = not ESPAtivo
        botaoESP.Text = ESPAtivo and "ESP: ON" or "ESP: OFF"
    end)

    -- Botão Speed
    local botaoSpeed = Instance.new("TextButton")
    botaoSpeed.Size = UDim2.new(1, -20, 0, 30)
    botaoSpeed.Position = UDim2.new(0, 10, 0, 80)
    botaoSpeed.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    botaoSpeed.TextColor3 = Color3.fromRGB(255, 255, 255)
    botaoSpeed.Text = "Speed: OFF"
    botaoSpeed.Parent = frame

    botaoSpeed.MouseButton1Click:Connect(function()
        SpeedAtivo = not SpeedAtivo
        botaoSpeed.Text = SpeedAtivo and "Speed: ON" or "Speed: OFF"
        local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = SpeedAtivo and VelocidadeDesejada or 16
        end
    end)

    -- Botão Fechar Painel
    local botaoFechar = Instance.new("TextButton")
    botaoFechar.Size = UDim2.new(1, -20, 0, 30)
    botaoFechar.Position = UDim2.new(0, 10, 0, 120)
    botaoFechar.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
    botaoFechar.TextColor3 = Color3.fromRGB(255, 255, 255)
    botaoFechar.Text = "Fechar Painel"
    botaoFechar.Parent = frame

    botaoFechar.MouseButton1Click:Connect(function()
        frame.Visible = false
        InterfaceAberta = false
    end)

    -- Botão para reabrir painel
    local reabrir = Instance.new("TextButton")
    reabrir.Size = UDim2.new(0, 120, 0, 30)
    reabrir.Position = UDim2.new(0, 10, 1, -40)
    reabrir.Text = "Abrir Painel"
    reabrir.TextColor3 = Color3.fromRGB(255, 255, 255)
    reabrir.BackgroundColor3 = Color3.fromRGB(0, 100, 0)
    reabrir.Parent = gui

    reabrir.MouseButton1Click:Connect(function()
        frame.Visible = true
        InterfaceAberta = true
    end)
end

-- Criar ESP para um jogador
local function CriarESP(player)
    if player == game.Players.LocalPlayer then return end
    if player.Team and player.Team == game.Players.LocalPlayer.Team then return end

    local espText = Drawing.new("Text")
    espText.Text = player.Name
    espText.Size = 14
    espText.Center = true
    espText.Outline = true
    espText.Color = Color3.fromRGB(255, 0, 0)
    espText.Visible = false

    DesenhosESP[player] = espText
end

-- Atualizar ESP
local function AtualizarESP()
    game:GetService("RunService").RenderStepped:Connect(function()
        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                if not DesenhosESP[player] then
                    CriarESP(player)
                end

                local esp = DesenhosESP[player]
                local char = player.Character
                local hrp = char and char:FindFirstChild("HumanoidRootPart")

                if ESPAtivo and hrp then
                    local pos, vis = workspace.CurrentCamera:WorldToViewportPoint(hrp.Position)
                    if vis then
                        esp.Position = Vector2.new(pos.X, pos.Y - 20)
                        esp.Visible = true
                        esp.Text = player.Name
                    else
                        esp.Visible = false
                    end
                elseif esp then
                    esp.Visible = false
                end
            end
        end

        -- Speed manter ativo
        if SpeedAtivo then
            local humanoid = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid and humanoid.WalkSpeed ~= VelocidadeDesejada then
                humanoid.WalkSpeed = VelocidadeDesejada
            end
        end
    end)
end

-- Remover ESP ao sair
game.Players.PlayerRemoving:Connect(function(player)
    if DesenhosESP[player] then
        DesenhosESP[player]:Remove()
        DesenhosESP[player] = nil
    end
end)

-- Criar ESP para novos jogadores
game.Players.PlayerAdded:Connect(function(player)
    CriarESP(player)
end)

-- Inicializar
CriarInterface()
AtualizarESP()

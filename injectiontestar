-- ESP Script com Interface Simples e Team Check
-- Feito para fins de teste autorizados

-- Configuração
local ESPAtivo = false
local DesenhosESP = {}

-- Interface Simples (GUI)
local function CriarInterface()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "ESP_Interface"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

    local botao = Instance.new("TextButton")
    botao.Name = "BotaoESP"
    botao.Size = UDim2.new(0, 100, 0, 40)
    botao.Position = UDim2.new(0, 10, 0, 10)
    botao.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    botao.TextColor3 = Color3.fromRGB(255, 255, 255)
    botao.Text = "ESP: OFF"
    botao.Parent = screenGui

    botao.MouseButton1Click:Connect(function()
        ESPAtivo = not ESPAtivo
        botao.Text = ESPAtivo and "ESP: ON" or "ESP: OFF"
    end)
end

-- Criar ESP para um jogador
local function CriarESP(player)
    if player == game.Players.LocalPlayer then return end
    if player.Team and player.Team == game.Players.LocalPlayer.Team then return end

    local text = Drawing.new("Text")
    text.Text = player.Name
    text.Size = 14
    text.Center = true
    text.Outline = true
    text.Color = Color3.fromRGB(255, 0, 0)
    text.Visible = false

    DesenhosESP[player] = text
end

-- Atualizar ESP continuamente
local function AtualizarESP()
    game:GetService("RunService").RenderStepped:Connect(function()
        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                if not DesenhosESP[player] then
                    CriarESP(player)
                end

                local drawing = DesenhosESP[player]
                local character = player.Character
                local hrp = character and character:FindFirstChild("HumanoidRootPart")

                if ESPAtivo and hrp then
                    local pos, visible = workspace.CurrentCamera:WorldToViewportPoint(hrp.Position)
                    if visible then
                        drawing.Position = Vector2.new(pos.X, pos.Y - 20)
                        drawing.Text = player.Name
                        drawing.Visible = true
                    else
                        drawing.Visible = false
                    end
                elseif drawing then
                    drawing.Visible = false
                end
            end
        end
    end)
end

-- Limpar ESP ao jogador sair
game.Players.PlayerRemoving:Connect(function(player)
    if DesenhosESP[player] then
        DesenhosESP[player]:Remove()
        DesenhosESP[player] = nil
    end
end)

-- Atualizar ESP quando novos jogadores entrarem
game.Players.PlayerAdded:Connect(function(player)
    CriarESP(player)
end)

-- Inicializar
CriarInterface()
AtualizarESP()
